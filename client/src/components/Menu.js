import React, { useState, useEffect } from 'react';

function Menu() {
  const [menu, setMenu] = useState([]);

  useEffect(() => {
    fetch('/api/menu')
      .then(res => res.json())
      .then(data => setMenu(data))
      .catch(err => console.error("Error fetching menu:", err));
  }, []);

  return (
    <section className="menu">
      <h2>Our Menu</h2>
      {menu.map(category => (
        <div key={category.category}>
          <h3>{category.category}</h3>
          <ul>
            {category.items.map(item => (
              <li key={item.name}>
                <h4>{item.name}</h4>
                <p>{item.description}</p>
                <p className="price">${item.price}</p>
              </li>
            ))}
          </ul>
        </div>
      ))}
    </section>
  );
}

export default Menu;